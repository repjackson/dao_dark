template(name='delta')
    with schema
        .ui.stackable.grid
            .row
                // .twelve.wide.column.padleft.scrolling(class=delta_left_column_class)
                .four.wide.column.padleft.scrolling
                    // a.ui.right.corner.label.move_left
                    //     i.left.chevron.link.icon
                    .ui.large.center.aligned.header
                        if color_icon
                            +icolor name=color_icon
                        else
                            i.icon(class=icon)
                        | #{plural}
                    // .ui.small.center.aligned.header #{body}
                    unless is_loading
                        if can_add
                            .ui.circular.button.add_type_doc(title="Add #{title}")
                                // i.plus.large.icon
                                +icolor name='plus' classes='ui avatar image'
                                |Add #{title}
                        if can_edit
                            +edit_button
                            // .ui.circular.button.edit_schema
                            //     i.cog.icon
                            //     | Configure #{plural}
                        // .ui.divider
                        // // each sessions
                        // //     .ui.icon.large.circular.button.select_session(class=session_selector_class title='select session')
                        // //         i.play.icon
                                
                        if current_delta
                            if is_dev
                                .ui.icon.button.print_delta(title='Print Session Doc')
                                    i.code.icon
                                    // |Print Session
                                .ui.reset.icon.button(title='Reload Session')
                                    i.refresh.icon
                                    // |Reload Session
                                .ui.delete_delta.icon.button(title='Delete Session')
                                    i.trash.icon
                                    // |Delete Session
                        else
                            .create_delta.ui.circular.basic.button.pointer(title='new session')
                                i.plus.icon
                                |Create Session
                    // |did: #{session_delta_id}
                            
                    each current_delta.facets
                        +facet
                // .column(class=delta_right_column_class)
                .eight.wide.column
                    // a.ui.left.corner.label.move_right
                    //     i.right.chevron.link.pointer.icon
                    // .ui.horizontal.spaced.list
                    //     .item
                    //         |View
                    //         +set_page_size value=10
                    //         +set_page_size value=20
                    //         +set_page_size value=50
                    //     .item
                    //         if multiple_pages
                    //             .ui.label
                    //                 | Page #{delta.current_page}/#{delta.page_amount}
                    //     .item
                    //             | #{delta.total} Results
                    //     .item
                    //         if show_page_down
                    //             .ui.icon.circular.button.page_down(title='Previous Page')
                    //                 i.left.chevron.icon
                    //         if show_page_up
                    //             .ui.icon.circular.button.page_up(title='Next Page')
                    //                 i.right.chevron.icon
                    //     .item
                    //         +set_delta_key key='view' value='grid' icon='clone'                                    
                    //         +set_delta_key key='view' value='table' icon='table'                                    
                    //     .item
                    //         +toggle_delta_config key='minimize' title='Minimize' label='Minimize' icon='chevron up'
                    //     .item
                    //         .ui.disabled.circular.button
                    //             i.sort.down.icon
                    //             |Sort By
                    //     .item
                    //         .ui.disabled.circular.button
                    //             i.filter.icon
                    //             | Toggle Fields
                    // .ui.stackable.grid.scrolling(class=result_grid_class)
                    .scrolling
                        each current_delta.result_ids
                            +result
                .four.wide.column
                    +events_column
                
template(name='events_column')
    .ui.accordion
        h4.active.title
            // +icolor name='edit-property' classes='ui inline image'
                // .ui.inline.dividing.header 
            i.rss.icon
            | Log
            i.dropdown.icon
        .active.content
            .ui.feed
                each events
                    .event
                        .label
                            img.ui.image(src="{{c.url object.profile.image_id width=400 height=400 gravity='face' crop='fill'}}")
                        .content
                            .summary
                                |#{body}
                                .date
                                    |#{when}
                                if is_dev
                                    +remove_button




template(name='facet')
    if filtering_res
        .ui.accordion
            .active.title
                .ui.header 
                    if icon
                        i.small.grey.icon(class=icon)
                    |#{label}
                    // i.grey.dropdown.icon
            .active.content
                // .ui.transparent.left.icon.small.input
                //     i.search.icon
                //     input.add_filter(type='text' placeholder='search')
                // i.dropdown.icon
                // each filters
                //     .unselect.ui.grey.circular.button #{this}
                each filtering_res
                    if name
                        .selector.ui.circular.button.toggle_selection(class=toggle_value_class title=count)
                            | #{name}
                            // small #{count}
                    else
                        .selector.ui.circular.button.toggle_selection(class=toggle_value_class title=count)
                            strong [null]
                            // small #{count}
    
        // div
        // if icon
        //     i.grey.icon(class=icon)
        // .ui.small.inline.header 
        //     |#{label}
        // // .ui.transparent.left.icon.small.input
        // //     i.search.icon
        // //     input.add_filter(type='text' placeholder='search')
        // // i.dropdown.icon
        // // each filters
        // //     .unselect.ui.grey.circular.button #{this}
        // each filtering_res
        //     if name
        //         .selector.ui.compact.button.toggle_selection(class=toggle_value_class title=count)
        //             | #{name}
        //             // small #{count}
        //     else
        //         .selector.ui.compact.button.toggle_selection(class=toggle_value_class title=count)
        //             strong [null]
        //         // small #{count}



template(name='toggle_delta_config')
    if boolean_true
        .ui.grey.active.icon.circular.button.disable_key(title=label)
            i.icon(class=icon)
            // | #{label}
    else
        .ui.icon.circular.button.enable_key(title=label)
            i.icon(class=icon)
            // | #{label}



template(name='set_page_size')
    .ui.icon.circular.button.set_page_size(class=page_size_class title='Page Size')
        .middle.aligned #{value}

template(name='set_delta_key')
    .ui.icon.circular.button.set_delta_key(class=set_delta_key_class)
        if icon
            i.icon(class=icon)
        // |#{label}



template(name='result')
    with result 
        .ui.result.fluid.segment(class="{{#if is_loading}}loading{{/if}}")
            .content
                a.ui.header(href="/t/#{ct.slug}/s/#{type}/#{_id}/view")
                    if logo_id
                        img.ui.avatar.image(src="{{c.url logo_id width=100 height=100 gravity='face' crop='fill'}}")
                    else if icon
                        i.icon(class=icon)
                    each bricks
                        if header
                            +Template.dynamic template=view_template 
                    // |#{title}
                .description
                    // each schema.field_templates
                    //     with field_template_doc
                    //         +Template.dynamic template=view_template
                    each bricks
                        unless header
                            +Template.dynamic template=view_template 
                .extra
                    // +user_list_toggle key='bookmark_ids' icon='bookmark' label='Bookmark' color='red'
                    if can_edit
                        +edit_button
                        +view_button
                    each schema.actions
                        +Template.dynamic template=this data=..
                    // +author_info
                    +creation_info

    
    //     each _keys
    //         // .ui.label #{this}
    //         +key_view
    //     if visual_classes
    //         +visual_classes
    //     if analyzed_text
    //         |#{nl2br analyzed_text}

    //     +view_button
    //     +edit_button
    // .ui.divider

    
                    









template(name='type_edit')
    with doc
        .ui.stackable.padded.grid
            .centered.row
                .four.wide.column
                    .ui.header(title="Type: #{type}")
                        each bricks
                            if header
                                +Template.dynamic template=view_template 
                    // +ioffice name='pencil' classes='ui inline image'
                    +creation_info
                    +save_button
                    +remove_button
                .twelve.wide.column
                    each small_bricks
                        +Template.dynamic template=edit_template 
                    each big_bricks
                        +Template.dynamic template=edit_template 
                        // .ui.header #{key} [#{field}] #{label}


template(name='type_view')
    with doc
        .ui.stackable.padded.grid
            .row
                .sixteen.wide.column
                    .ui.breadcrumb
                        a.section(href="/t/#{ct.slug}")
                            +icolor name=ct.color_icon classes='ui mini inline image'
                            |#{ct.title}
                            // .ui.circular.compact.button
                        .divider
                            i.chevron.right.large.icon
                        a.set_tribe_schema.section(href="/t/#{ct.slug}/s/#{type}" title=schema.plural)
                            if schema.color_icon
                                +icolor name=schema.color_icon classes='ui mini inline image'
                            // else
                            // i.icon(class=schema.icon)
                            |#{schema.plural}
                            // .ui.circular.compact.button
                        .divider
                            i.chevron.right.large.icon
                        .active.section
                            if icon
                                i.icon(class=icon)
                            if title
                                |#{title}
                            else
                                |View #{type}
            .row
                .four.wide.column
                    // .ui.header
                    //     a.ui.icon.circular.button(href="/s/#{type}" title=plural)
                    //         i.chevron.left.icon
                    //     |View #{type}
                    if can_edit
                        +edit_button
                    each schema.actions
                        +Template.dynamic template=this data=doc
                    // +user_list_toggle key='bookmark_ids' icon='bookmark' label='Bookmark' color='red'
                    +creation_info
                .twelve.wide.column
                    .ui.header
                        each bricks
                            if header
                                +Template.dynamic template=view_template 
                        // if icon
                        //     i.icon(class=icon)
                        // |#{title}
                    each bricks
                        unless header
                            .item
                                +Template.dynamic template=view_template 
                    div
                    +comments
                    
                    
